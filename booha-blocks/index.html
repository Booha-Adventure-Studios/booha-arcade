<!-- =========================
   BOOHA BLOCKS (CLEAN)
   FULL FILE (CLEANED + FIXED)
   âœ… Single unified game loop
   âœ… ONE leaderboard system (localStorage + NAME prompt)
   âœ… ONE leaderboard overlay (no duplicate IDs)
   âœ… Consistent flags: isGameOver / isPaused / isPausedForQuestion / gameStarted
   âœ… Fixed resumeLoop + keyboard checks
   âœ… Fixed saveLocalScore (uses linesClearedTotal + name)
   âœ… Game Over overlay + tap-to-restart
   âœ… Mobile â†“ = ONE STEP DROP (no slam / no fast drop)
   âœ… Mobile â† â†’ wider buttons + bigger tap hitbox
   âœ… Extra glow / arcade sparkle polish
   ========================= -->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Booha Blocks â€“ One 5 Zero</title>

  <link rel="icon" type="image/png" sizes="32x32" href="BooBlocks.png">
  <link rel="apple-touch-icon" href="BooBlocks.png">

  <meta name="viewport"
        content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">

  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700;900&family=Noto+Sans+JP:wght@500;700&display=swap" rel="stylesheet">

  <style>
  :root{
    --pink:#ff7eb9;
    --aqua:#7dd3fc;
    --gold:#ffd166;
    --outline:rgba(255,255,255,0.35);

    --pulse:0;
    --pulse2:0;
    --flash:0;
    --screenGlow:0;
  }

  /* RESET */
  *{margin:0;padding:0;box-sizing:border-box;}
  html,body{height:100%;width:100%;overflow:hidden;}

  html{
    -webkit-text-size-adjust:100%;
    overscroll-behavior:none; /* âœ… kill rubber-band */
    touch-action:none;         /* âœ… kill pan/zoom (prevents iOS double-tap zoom) */
    -webkit-user-select:none;  /* âœ… stop Android selection */
    user-select:none;          /* âœ… stop Android selection */
  }
  body{
    overscroll-behavior:none;
    touch-action:none;         /* âœ… kill pan/zoom */
    -webkit-user-select:none;  /* âœ… stop Android selection */
    user-select:none;          /* âœ… stop Android selection */
  }

  body{
    display:flex;
    align-items:flex-start;
    justify-content:center;

    /* âœ… avoid vh jumps on mobile bars */
    padding-top:4svh;
    padding-bottom:4svh;

    background:
      radial-gradient(circle at 50% 30%,
        rgba(255,255,255, calc(0.10 * var(--pulse))) 0%,
        rgba(0,0,0,0) 38%),
      radial-gradient(circle at 20% 15%,
        color-mix(in srgb, var(--pink) 60%, transparent) calc(10% * var(--pulse2)),
        transparent 45%),
      radial-gradient(circle at 80% 85%,
        color-mix(in srgb, var(--aqua) 60%, transparent) calc(10% * var(--pulse2)),
        transparent 50%),
      radial-gradient(circle at top, #1f2937 0%, #020617 55%, #000000 100%);

    font-family:'Noto Sans JP', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    color:#f9fafb;
    overflow:hidden;
  }

  /* iOS/iPad: STOP tap zoom + selection + callouts (but donâ€™t break controls) */
  body, html, .shell, canvas, #startOverlay, #questionOverlay,
  #mobileControls, #mobileDownRow,
  .mob-btn, #moveDownBtn, .choiceBtn, .topbar, .topbar *{
    -webkit-user-select:none;
    user-select:none;
    -webkit-touch-callout:none;
    -webkit-tap-highlight-color: transparent;
    -webkit-user-drag:none;
    user-drag:none;
  }

  /* âœ… Allow buttons to behave nicely (tap, no zoom) */
  .mob-btn, #moveDownBtn, .choiceBtn, #helpBtn, #trophyBtn, #pauseBtn,
  #leaderClose, #lbClearBtn{
    touch-action: manipulation;
  }

  /* âœ… Game canvas: never allow scrolling/zooming gestures */
  #game{
    touch-action:none;
    -ms-touch-action:none;
  }

  /* whole-screen bloom */
  body::before{
    content:"";
    position:fixed;
    inset:-6%;
    pointer-events:none;
    z-index:4;
    opacity:calc(0.14 * var(--screenGlow));
    background:
      radial-gradient(circle at 50% 45%,
        rgba(255,255,255,0.95) 0%,
        rgba(255,255,255,0.0) 58%),
      radial-gradient(circle at 20% 25%,
        color-mix(in srgb, var(--pink) 60%, transparent) 0%,
        transparent 60%),
      radial-gradient(circle at 80% 75%,
        color-mix(in srgb, var(--aqua) 60%, transparent) 0%,
        transparent 62%);
    filter:blur(22px);
    mix-blend-mode:screen;
    transition:opacity .08s ease;
  }

  /* whole-screen flash */
  body::after{
    content:"";
    position:fixed;
    inset:0;
    pointer-events:none;
    z-index:5;
    opacity:calc(0.18 * var(--flash));
    background:
      radial-gradient(circle at 30% 30%,
        color-mix(in srgb, var(--pink) 60%, transparent) 0%,
        transparent 55%),
      radial-gradient(circle at 70% 70%,
        color-mix(in srgb, var(--aqua) 60%, transparent) 0%,
        transparent 60%),
      radial-gradient(circle at 50% 50%,
        rgba(255,255,255,0.20) 0%,
        transparent 62%);
    filter:blur(14px);
    mix-blend-mode:screen;
    transition:opacity .10s ease;
  }

  /* PHONE SHELL */
  .shell{
    position:relative;
    padding:18px 22px 32px;
    border-radius:24px;
    background:radial-gradient(circle at top,rgba(148,163,255,0.25),rgba(15,23,42,0.98));
    border:1px solid rgba(148,163,255,0.5);
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:10px;

    width:min(480px, 100vw - 24px);
    max-height:96vh;

    text-align:center;

    /* extra arcade glow */
    box-shadow:
      0 0 24px rgba(255,209,102,0.10),
      0 0 60px rgba(125,211,252,0.10),
      inset 0 0 18px rgba(255,255,255,0.06);
  }

  /* iPhone Safari bottom bar fix */
  @supports (-webkit-touch-callout:none) {
    body{ padding-bottom:calc(4svh + env(safe-area-inset-bottom, 0px)); }
    .shell{ padding-bottom:calc(32px + env(safe-area-inset-bottom, 0px)); }
  }

  /* shell halo */
  .shell::before{
    content:"";
    position:absolute;
    inset:-2px;
    border-radius:26px;
    background:
      radial-gradient(circle at 0% 0%,rgba(236,72,153,0.27),transparent 60%),
      radial-gradient(circle at 100% 100%,rgba(56,189,248,0.24),transparent 60%);
    z-index:-1;
    filter:blur(10px);
    opacity:0.9;
    animation:orbGlow 6s ease-in-out infinite alternate;
  }

  /* reactive shell glow */
  .shell::after{
    content:"";
    position:absolute;
    inset:-6px;
    border-radius:30px;
    pointer-events:none;
    z-index:-2;
    filter:blur(14px);
    opacity:calc(0.12 + (0.68 * var(--pulse)) + (0.35 * var(--flash)));
    background:
      radial-gradient(circle at 30% 25%,
        color-mix(in srgb, var(--pink) 78%, transparent) 0%,
        transparent 55%),
      radial-gradient(circle at 70% 75%,
        color-mix(in srgb, var(--aqua) 78%, transparent) 0%,
        transparent 60%),
      radial-gradient(circle at 50% 50%,
        rgba(255,255,255,0.20) 0%,
        transparent 60%);
    transition:opacity .10s ease;
  }

  @keyframes orbGlow{
    0%{transform:translate3d(-4px,-4px,0) scale(1);}
    100%{transform:translate3d(4px,4px,0) scale(1.02);}
  }

  /* scale hub down on short screens */
  @media (max-height:780px){
    .shell{ transform:scale(0.9); transform-origin: top center; }
  }
  @media (max-height:700px){
    .shell{ transform:scale(0.82); transform-origin: top center; }
  }

  /* TOPBAR (âœ… title centered between ? and ğŸ†) */
  .topbar{
    width:100%;
    display:grid;
    grid-template-columns: 36px 1fr auto;
    align-items:center;
    gap:10px;
    padding-top:2px;
  }
  .topbar .leftSlot{ justify-self:start; }
  .topbar .titleSlot{ justify-self:center; text-align:center; }
  .topbar .rightSlot{ justify-self:end; display:flex; gap:8px; }

  /* TITLE */
  h1{
    margin:0;
    font-family:'Cinzel',serif;
    font-weight:900;
    letter-spacing:0.12em;
    font-size:1.05rem;
    text-transform:uppercase;
    text-align:center;
    color:#e5e7eb;
    text-shadow:
      0 0 8px rgba(248,250,252,0.9),
      0 0 16px rgba(251,113,133,0.8);
  }
  h1 span{
    display:block;
    font-size:0.8rem;
    letter-spacing:0.28em;
    color:#a5b4fc;
    text-shadow:none;
    margin-top:2px;
  }

  /* TOP BUTTONS */
  #helpBtn,#trophyBtn,#pauseBtn{
    width:36px;
    height:36px;
    border-radius:50%;
    border:1px solid var(--gold);
    background:linear-gradient(135deg,var(--pink),var(--aqua));
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:20px;
    cursor:pointer;
    box-shadow:0 0 12px rgba(255,255,255,0.7);
    z-index:15;
  }

  /* HUD */
  .hud-row{
    width:100%;
    display:flex;
    justify-content:space-between;
    font-size:0.8rem;
    color:#e5e7eb;
    text-align:left;
  }
  .hud-row .label{opacity:0.8;}
  .hud-row .value{
    color:var(--gold);
    text-shadow:0 0 6px #ffd166;
  }
  .hud-row .next{
    color:var(--pink);
    text-shadow:0 0 6px color-mix(in srgb, var(--pink) 70%, white);
  }

  /* GAME CANVAS */
  #game{
    margin-top:8px;
    border-radius:18px;
    border:1px solid var(--outline);
    background:radial-gradient(circle at top,#020617 0%,#000 50%,#020617 100%);
    box-shadow:
      0 0 calc(18px + (26px * var(--pulse))) color-mix(in srgb, var(--aqua) 55%, transparent),
      0 0 calc(38px + (60px * var(--pulse))) rgba(15,23,42,0.9),
      0 0 calc(10px + (22px * var(--pulse))) color-mix(in srgb, var(--pink) 45%, transparent),
      0 0 calc(18px + (38px * var(--flash))) rgba(255,255,255,0.28);
    image-rendering:pixelated;
    touch-action:none;

    width:auto;
    max-width:100%;
    height:min(62svh, 640px);

    display:block;

    /* subtle animated glow */
    animation:canvasPulseGlow 2.4s ease-in-out infinite;
  }
  @keyframes canvasPulseGlow{
    0%{ filter: drop-shadow(0 0 5px rgba(255,209,102,0.22)) drop-shadow(0 0 20px rgba(125,211,252,0.12)); }
    50%{ filter: drop-shadow(0 0 10px rgba(255,209,102,0.30)) drop-shadow(0 0 34px rgba(125,211,252,0.18)); }
    100%{ filter: drop-shadow(0 0 5px rgba(255,209,102,0.22)) drop-shadow(0 0 20px rgba(125,211,252,0.12)); }
  }

  /* iPad: bigger board */
  @media (pointer:coarse) and (min-width:768px){
    #game{ height:min(68svh, 760px); }
  }

  /* SPARKLES */
  .sparkle-overlay{
    pointer-events:none;
    position:absolute;
    inset:0;
    overflow:hidden;
    border-radius:24px;
    mix-blend-mode:screen;
    opacity:0.45;
  }
  .spark{
    position:absolute;
    width:3px;height:3px;border-radius:50%;
    background:radial-gradient(circle,#e5e7eb 0%,rgba(244,244,245,0) 70%);
    box-shadow:0 0 8px rgba(255,255,255,0.9);
    animation:floatUp 8s linear infinite;
  }
  .spark:nth-child(2){animation-duration:10s;}
  .spark:nth-child(3){animation-duration:12s;}
  .spark:nth-child(4){animation-duration:9s;}
  .spark:nth-child(5){animation-duration:11s;}
  .spark:nth-child(6){animation-duration:13s;}
  @keyframes floatUp{
    0%{transform:translate3d(0,120%,0) scale(0.6); opacity:0;}
    18%{opacity:1;}
    80%{opacity:1;}
    100%{transform:translate3d(0,-40%,0) scale(1.05); opacity:0;}
  }

  /* MOBILE CONTROLS */
  #mobileControls{
    display:none;
    width:100%;
    justify-content:center;
    gap:12px;
    margin-top:8px;
  }
  #mobileDownRow{
    display:none;
    width:100%;
    justify-content:center;
    margin-top:6px;
  }

  .mob-btn{
    width:52px;
    height:52px;
    border-radius:50%;
    border:1px solid var(--gold);
    background:linear-gradient(135deg,var(--pink),var(--aqua));
    box-shadow:0 0 12px rgba(255,255,255,0.7);
    font-size:22px;
    color:#111827;
    display:flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
    -webkit-tap-highlight-color: transparent;
    position:relative;
    transition:transform .08s ease, box-shadow .14s ease, filter .14s ease;
  }
  .mob-btn:active{
    transform:translateY(1px) scale(0.99);
    box-shadow:0 0 18px rgba(255,209,102,0.35);
    filter:brightness(1.05);
  }



/* âœ… bigger hit area (general) */
.mob-btn::before{
  content:"";
  position:absolute;
  inset:-14px;
}

#rotateBtn{
  background:radial-gradient(circle at 30% 20%, #fdf2ff, #e879f9 40%, #a855f7 80%);
  box-shadow:0 0 18px rgba(232,121,249,0.9);
}

/* space-bar down */
#moveDownBtn{
  width:100%;
  max-width:260px;
  height:44px;
  border-radius:14px;
  font-size:18px;
  font-weight:900;

  background:linear-gradient(180deg,#fde68a,#f59e0b);
  color:#1f2937;

  box-shadow:
    0 6px 18px rgba(245,158,11,0.6),
    inset 0 1px 0 rgba(255,255,255,0.6);
}
#moveDownBtn:active{
  transform:translateY(1px);
  box-shadow:
    0 3px 10px rgba(245,158,11,0.8),
    inset 0 2px 4px rgba(0,0,0,0.25);
}

/* âœ… Mobile arrows: wider pill shape + bigger tap zone */
#moveLeftBtn,
#moveRightBtn{
  width:104px;
  height:52px;
  border-radius:999px;
  font-size:22px;
}
#moveLeftBtn::before,
#moveRightBtn::before{
  inset:-16px -24px;
}

/* show controls on touch devices */
@media (pointer:coarse){
  #mobileControls,#mobileDownRow{display:flex;}
  .shell{ padding-bottom:calc(32px + 88px + env(safe-area-inset-bottom,0px)); }
}

/* PAUSE OVERLAY */
#pauseOverlay{
  position:absolute;
  inset:0;
  border-radius:24px;
  background:rgba(0,0,0,0.6);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:25;
  font-size:0.95rem;
  text-shadow:0 0 6px #fff;
}

/* HELP OVERLAY */
#helpOverlay{
  position:absolute;
  inset:0;
  border-radius:24px;
  background:rgba(0,0,15,0.8);
  backdrop-filter:blur(6px);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:30;
}
.help-card{
  width:88%;
  max-width:380px;
  padding:18px 20px 16px;
  border-radius:18px;
  background:radial-gradient(circle,#111827,#020617 60%);
  border:1px solid rgba(255,255,255,0.25);
  position:relative;
  color:#e5e7eb;
  font-size:0.8rem;
  text-align:left;
}
.help-title{
  font-family:'Cinzel';
  text-align:center;
  font-size:1.1rem;
  margin-bottom:8px;
}
#helpClose{
  position:absolute;
  top:8px;
  right:8px;
  width:26px;
  height:26px;
  border-radius:50%;
  background:linear-gradient(135deg,var(--pink),var(--aqua));
  border:1px solid var(--gold);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:16px;
  cursor:pointer;
  box-shadow:0 0 8px rgba(255,255,255,0.7);
}

/* QUESTION OVERLAY */
#questionOverlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,20,0.82);
  backdrop-filter:blur(8px);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:50;
  padding:calc(14px + env(safe-area-inset-top,0px)) 14px calc(14px + env(safe-area-inset-bottom,0px));
}

.q-card{
  width:min(92vw,520px);
  border-radius:22px;
  padding:18px 18px 16px;
  position:relative;
  overflow:hidden;
  background:
    radial-gradient(circle at top, rgba(255,255,255,0.10), transparent 45%),
    radial-gradient(circle at 20% 10%, color-mix(in srgb, var(--pink) 45%, transparent) 0%, transparent 55%),
    radial-gradient(circle at 85% 90%, color-mix(in srgb, var(--aqua) 45%, transparent) 0%, transparent 60%),
    radial-gradient(circle at top,#111827,#020617 65%,#020617 100%);
  border:1px solid rgba(248,250,252,0.28);
  box-shadow:
    0 0 26px color-mix(in srgb, var(--pink) 55%, transparent),
    0 0 70px color-mix(in srgb, var(--aqua) 45%, transparent);
  color:#f9fafb;
  max-height:min(86svh, 680px);
  overflow:auto;
  display:flex;
  flex-direction:column;
  align-items:center;
}

/* iOS zoom prevention (correct way) */
button, input, select, textarea{
  font-size:16px;
}

/* âŒ REMOVED: global touch-action:none block */
/* Gesture locking remains ONLY on #game and mobile controls */

/* ==============================
   LEADERBOARD OVERLAY (LOCAL)
   ============================== */
#leaderboardOverlay{
  position:fixed;
  inset:0;
  z-index:9999;
  display:none;
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,.65);
  backdrop-filter: blur(8px);
  padding:14px;
}

#leaderboardCard{
  width:min(560px,92vw);
  max-height:80vh;
  overflow:auto;
  border-radius:24px;
  padding:18px;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(10,10,16,.92);
  box-shadow:0 20px 80px rgba(0,0,0,.6);
  color:#fff;
}

.lbTop{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  margin-bottom:12px;
}

.lbTitle{
  font-family:"Cinzel", serif;
  font-weight:900;
  letter-spacing:.8px;
  font-size:20px;
}

.lbClose{
  font:inherit;
  font-weight:900;
  padding:10px 14px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.22);
  background:rgba(255,255,255,.08);
  color:#fff;
}

.lbList{
  display:grid;
  gap:10px;
  margin:12px 0 14px;
}

.lbRow{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  padding:10px 12px;
  border-radius:16px;
  background:rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.12);
}

.lbLeft{
  display:flex;
  align-items:baseline;
  gap:10px;
  flex-wrap:wrap;
}

.lbRank{
  font-weight:900;
  min-width:44px;
}

.lbMeta{ opacity:.92; }
.lbDim{ opacity:.75; }

.lbClear{
  width:100%;
  font:inherit;
  font-weight:900;
  padding:12px 14px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.22);
  background:rgba(255,209,102,.95);
  color:#000;
}


/* ==============================
   DESKTOP FIX (Step 1 â€” board only)
   ============================== */
@media (min-width: 900px){

  /* Keep your nice layout â€” donâ€™t giant-stretch the whole shell */
  .shell, .gameShell, .outerShell, .wrap, .frame{
    width: min(900px, 94vw) !important;
    max-height: 90vh !important;
  }

  /* IMPORTANT: do NOT force canvas height rules that fight DPR scaling */
  canvas, .gameCanvas, #game, #board{
    height: auto !important;
  }

  /* Force the PLAYFIELD/BOARD to a sane desktop size (preserve 10x20 ratio) */
  #game, #board, canvas#game, canvas#board{
    width: clamp(340px, 28vw, 520px) !important;
    height: auto !important;
    aspect-ratio: 1 / 2 !important; /* âœ… Tetris is 10x20 */
    display: block !important;
    margin: 0 auto !important;
    max-height: calc(90vh - 220px) !important; /* âœ… keep within desktop view */
  }
}

</style>


</head>

<body>

<!-- ==============================
     LEADERBOARD OVERLAY (LOCAL)
     ============================== -->
<div id="leaderboardOverlay" style="display:none;">
  <div id="leaderboardCard">
    <div class="lbTop">
      <div class="lbTitle">LEADERBOARD</div>
      <button id="leaderClose" class="lbClose" type="button">CLOSE</button>
    </div>

    <div id="leaderList" class="lbList"></div>

    <button id="lbClearBtn" class="lbClear" type="button">CLEAR SCORES</button>
  </div>
</div>

<!-- Tap-to-start / also used for GAME OVER -->
<div id="startOverlay">
  <div id="startOverlayInner">
    <span class="big">ç”»é¢ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ã‚¹ã‚¿ãƒ¼ãƒˆ</span>
    ãƒ–ãƒ­ãƒƒã‚¯ã‚’å‹•ã‹ã—ã¦ãƒ©ã‚¤ãƒ³ã‚’æ¶ˆãã†ï¼<br>
    ï¼•ãƒ©ã‚¤ãƒ³ã”ã¨ã«ãƒ–ãƒ¼ãƒã‚¯ã‚¤ã‚ºãŒå‡ºã¦ãã‚‹ã‚ˆã€‚
  </div>
</div>

<div class="shell">

  <!-- âœ… TOP BAR -->
<div class="topbar">
  <div class="leftSlot">
    <button id="helpBtn" type="button" aria-label="Help">ï¼Ÿ</button>
  </div>

  <div class="titleSlot">
  <h1>
    BOOHA BLOCKS
    <span>ãƒ–ãƒ¼ãƒãƒ¼ãƒ»ãƒ–ãƒ­ãƒƒã‚¯ã‚¹</span>
    <em>ONE 5 ZERO</em>
  </h1>
</div>


  <div class="rightSlot">
    <button id="trophyBtn" type="button" aria-label="Leaderboard">ğŸ†</button>
    <button id="pauseBtn" type="button" aria-label="Pause">â¸</button>
  </div>
</div>

<div class="hud-row">
  <div>
    <span class="label">ãƒ©ã‚¤ãƒ³ï¼š</span>
    <span class="value" id="linesCount">0</span>
  </div>
  <div>
    <span class="label">æ¬¡ã®ã‚¯ã‚¤ã‚ºï¼š</span>
    <span class="next" id="nextAt">5</span>
    <span class="label">ãƒ©ã‚¤ãƒ³</span>
  </div>
</div>

<div class="hud-row">
  <div>
    <span class="label">ã‚¹ã‚³ã‚¢ï¼š</span>
    <span class="value" id="scoreValue">0</span>
  </div>
  <div></div>
</div>


  <canvas id="game" width="320" height="640"></canvas>

  <div class="sparkle-overlay">
    <div class="spark" style="left:10%;"></div>
    <div class="spark" style="left:30%;"></div>
    <div class="spark" style="left:50%;"></div>
    <div class="spark" style="left:70%;"></div>
    <div class="spark" style="left:85%;"></div>
    <div class="spark" style="left:42%;"></div>
  </div>

  <div id="pauseOverlay"><div>ã‚¿ãƒƒãƒ—ã—ã¦ã‚²ãƒ¼ãƒ ã«æˆ»ã‚‹</div></div>

  <div id="helpOverlay">
    <div class="help-card">
      <div id="helpClose">âœ•</div>
      <div class="help-title">How to Play ï¼ éŠã³æ–¹</div>
      <div class="help-text">
        <p>â— å·¦ â† ã¨ å³ â†’ ãƒœã‚¿ãƒ³ã§ãƒ–ãƒ­ãƒƒã‚¯ã‚’å‹•ã‹ã™ã€‚</p>
        <p>â— ãƒ”ãƒ³ã‚¯ã®å›è»¢ãƒœã‚¿ãƒ³ã§ãƒ–ãƒ­ãƒƒã‚¯ã‚’å›ã™ã€‚</p>
        <p>â— ä¸‹ â†“ ãƒœã‚¿ãƒ³ã‚’ã€Œã‚¿ãƒƒãƒ—ã€ã™ã‚‹ã¨1ãƒã‚¹ä¸‹ã«è½ã¡ã‚‹ã€‚</p>
        <br>
        <p>â— Use â† and â†’ to move the block.</p>
        <p>â— Use the pink button to rotate the block.</p>
        <p>â— Tap the â†“ button to drop 1 square.</p>
        <br>
        <p>5ãƒ©ã‚¤ãƒ³ã”ã¨ã«ã‚¯ã‚¤ã‚ºãŒå‡ºã‚‹ã‚ˆï¼</p>
      </div>
    </div>
  </div>

  <div id="mobileControls">
    <div class="mob-btn" id="moveLeftBtn">â†</div>
    <div class="mob-btn" id="rotateBtn">â†»</div>
    <div class="mob-btn" id="moveRightBtn">â†’</div>
  </div>

  <div id="mobileDownRow">
    <div class="mob-btn" id="moveDownBtn">â†“ DROP</div>
  </div>

</div>

<!-- QUESTION OVERLAY -->
<div id="questionOverlay">
  <div class="q-card">
    <div class="q-title">Checkpoint</div>
    <div class="q-sub">Booha Question Gate</div>

    <div id="questionText"></div>
    <div id="choiceWrap"></div>

    <div class="q-note" id="qNote">â€» æ­£è§£ã™ã‚‹ã¾ã§é€²ã‚ã¾ã›ã‚“ï¼ˆ1å›ç›®ã§æ­£è§£ãªã‚‰ +100ï¼‰</div>
  </div>
</div>


<script>
/* âœ… iOS: prevent pinch / gesture zoom (safe version: no tap hijacking) */
(function iosNoZoom(){
  const opts = { passive: false };

  document.addEventListener("gesturestart", e => {
    if(e.cancelable) e.preventDefault();
  }, opts);

  document.addEventListener("gesturechange", e => {
    if(e.cancelable) e.preventDefault();
  }, opts);

  document.addEventListener("gestureend", e => {
    if(e.cancelable) e.preventDefault();
  }, opts);

  /* Stop only multi-touch moves (pinch). Do NOT block normal single taps. */
  document.addEventListener("touchmove", e => {
    if (e.touches && e.touches.length > 1){
      if(e.cancelable) e.preventDefault();
    }
  }, opts);
})();

/* âŒ REMOVED: iosNoZoomOnControls()
   It was preventingDefault on touchstart/touchend + calling el.click(),
   which causes iPhone/iPad tap lock + Android weird selection/tap behavior.
*/
</script>

<script>
/* ==============================
   BOOHA BLOCKS: FULL GAME CORE (CLEAN)
   ============================== */

/* --- Screen flicker helper: call flickerForClearedLines(linesClearedThisDrop) --- */
(function(){
  function easeOutQuad(t){ return 1 - (1 - t) * (1 - t); }

  function setRootVar(name, value){
    document.documentElement.style.setProperty(name, String(value));
  }

  window.flickerForClearedLines = function(n){
    if(!n || n <= 0) return;
    n = Math.min(4, Math.floor(n));

    const peakBase = 0.35 + (n - 1) * 0.33;
    const pulses = n;
    const singleDur = 180;

    let pulseIndex = 0;

    function runOnePulse(){
      const start = performance.now();
      const peak = peakBase * (1 + pulseIndex * 0.06);
      const glowPeak = Math.min(1.6, peak * 0.85);

      function step(ts){
        const elapsed = ts - start;
        const t = Math.min(1, elapsed / singleDur);

        // keep your original decay feel
        const decay = 1 - (1 - (1 - t)) * (1 - (1 - t));

        document.documentElement.style.setProperty('--flash', (peak * decay).toFixed(3));
        document.documentElement.style.setProperty('--pulse', (glowPeak * decay).toFixed(3));
        document.documentElement.style.setProperty('--screenGlow', (0.12 + (0.20 * peak) * decay).toFixed(3));

        if(t < 1){
          requestAnimationFrame(step);
        } else {
          pulseIndex++;
          if(pulseIndex < pulses){
            setTimeout(runOnePulse, 35);
          } else {
            document.documentElement.style.setProperty('--flash','0');
            document.documentElement.style.setProperty('--pulse','0');
            document.documentElement.style.setProperty('--screenGlow','0');
          }
        }
      }
      requestAnimationFrame(step);
    }

    runOnePulse();
  };
})();


/* âœ… Removed global document-level zoom/scroll blockers here.
   Reason: they cause iPhone/iPad "tap lock" + can interfere with clicks.
   We already handle zoom/gesture prevention safely in Part 3 + CSS touch-action rules.
*/


/* canvas */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const grid = 32;

/* ==============================
   STATE (âœ… one truth)
   ============================== */
let gameStarted = false;
let isGameOver = false;
let isPaused = false;
let isPausedForQuestion = false;

let score = 0;
let linesClearedTotal = 0;

let gravityFrames = 40;
let frameCounter = 0;
let rafId = 0;

/* HUD */
const linesEl = document.getElementById("linesCount");
const scoreEl = document.getElementById("scoreValue");
const nextAtEl = document.getElementById("nextAt");

/* overlays */
const startOverlay = document.getElementById("startOverlay");
const startInner   = document.getElementById("startOverlayInner");
const pauseOverlay = document.getElementById("pauseOverlay");
const helpOverlay  = document.getElementById("helpOverlay");

function updateHud(){
  linesEl.textContent = linesClearedTotal;
  scoreEl.textContent = score;

  // âœ… guard: currentQuestionIndex may not exist yet when HUD updates early
  const qIndex = (typeof currentQuestionIndex === "number" && isFinite(currentQuestionIndex))
    ? currentQuestionIndex
    : 0;

  nextAtEl.textContent = (qIndex + 1) * 5;
}

/* ==============================
   AUDIO (same folder) iPad-safe unlock
   ============================== */
let audioUnlocked = false;

const AUDIO_FILES = {
  bgmTracks: [
    "booha-tetris-january.mp3",
    "booha-tetris-january-2.mp3",
    "booha-tetris-january-3.mp3"
  ],
  lineClear: "booha-tetris-sound.mp3",
  quizOpen: "quiz.mp3",
  quizCorrect: "clear.mp3",
  levelUp: "correct.mp3",
};

const SFX = {
  bgm: null,               // current BGM Audio instance
  bgmVol: 0.28,
  bgmIndex: 0,
  bgmPendingAdvance: false, // track ended while paused/quiz
  bgmNeedsKick: false       // Safari blocked play; retry on next user gesture/resume
};

/* ---------- BGM builder + rotation ---------- */
function buildBGM(trackIndex){
  const src = AUDIO_FILES.bgmTracks[trackIndex] || AUDIO_FILES.bgmTracks[0];
  const a = new Audio(src);
  a.loop = false;
  a.preload = "auto";
  a.volume = SFX.bgmVol;

  a.onended = () => {
    // If we are not in active play, queue the next track (donâ€™t switch now)
    if(!audioUnlocked || !gameStarted || isGameOver || isPaused || isPausedForQuestion){
      SFX.bgmPendingAdvance = true;
      return;
    }
    // Active play: advance immediately
    advanceBGMAndPlay();
  };

  return a;
}

function advanceBGMIndex(){
  SFX.bgmIndex = (SFX.bgmIndex + 1) % AUDIO_FILES.bgmTracks.length;
}

function advanceBGMAndPlay(){
  advanceBGMIndex();
  SFX.bgm = buildBGM(SFX.bgmIndex);
  // try to start; if Safari blocks, mark for kick
  safePlay(SFX.bgm, { restart:false, isBGM:true });
}

function ensureBGM(){
  if(!SFX.bgm) SFX.bgm = buildBGM(SFX.bgmIndex);
}

/* ---------- Preload ---------- */
function preloadAllAudio(){
  try{
    ensureBGM();
    SFX.bgm.load();
  }catch(_){}

  try{ (new Audio(AUDIO_FILES.lineClear)).load(); }catch(_){}
  try{ (new Audio(AUDIO_FILES.quizOpen)).load(); }catch(_){}
  try{ (new Audio(AUDIO_FILES.quizCorrect)).load(); }catch(_){}
  try{ (new Audio(AUDIO_FILES.levelUp)).load(); }catch(_){}
}

/* ---------- iOS unlock ---------- */
async function unlockAudioOnce(){
  if(audioUnlocked) return;
  audioUnlocked = true;

  preloadAllAudio();
  ensureBGM();

  // Prime BGM silently (best effort)
  const prevVol = SFX.bgm.volume;
  try{
    SFX.bgm.volume = 0.0001;
    const p = SFX.bgm.play();
    if(p && typeof p.catch === "function") await p.catch(()=>{});
    try{ SFX.bgm.pause(); }catch(_){}
    try{ SFX.bgm.currentTime = 0; }catch(_){}
  }catch(_){}
  SFX.bgm.volume = prevVol;
}

/* ---------- Playback helpers ---------- */
function safePlay(audio, opts={}){
  if(!audioUnlocked || !audio) return;

  const restart = opts.restart !== false;
  const isBGM = !!opts.isBGM;

  // BGM safety: rebuild if missing or ended
  if(isBGM || audio === SFX.bgm){
    ensureBGM();
    audio = SFX.bgm;

    try{
      if(audio && audio.ended){
        // If ended, rebuild same index (resume will advance if needed)
        SFX.bgm = buildBGM(SFX.bgmIndex);
        audio = SFX.bgm;
      }
    }catch(_){}
  }

  try{
    if(restart){
      try{ audio.pause(); audio.currentTime = 0; }catch(_){}
    }
    const p = audio.play();
    if(p && typeof p.catch === "function"){
      p.catch(()=> {
        // iOS sometimes blocks late track starts; mark for retry
        if(isBGM || audio === SFX.bgm) SFX.bgmNeedsKick = true;
      });
    }
  }catch(_){
    if(isBGM || audio === SFX.bgm) SFX.bgmNeedsKick = true;
  }
}

function playSFX(url, vol=1){
  if(!audioUnlocked) return;
  try{
    // fresh instance per play (iOS-safe)
    const a = new Audio(url);
    a.preload = "auto";
    a.volume = vol;
    a.load();
    const p = a.play();
    if(p && typeof p.catch === "function") p.catch(()=>{});
  }catch(_){}
}

/* ---------- BGM control ---------- */
function pauseBGM(){
  try{
    if(SFX.bgm) SFX.bgm.pause();
  }catch(_){}
}

function resumeBGM(){
  if(!audioUnlocked) return;
  if(isGameOver) return;
  if(!gameStarted) return;
  if(isPaused || isPausedForQuestion) return;

  // If a track ended during pause/quiz, advance now
  if(SFX.bgmPendingAdvance){
    SFX.bgmPendingAdvance = false;
    advanceBGMIndex();
    SFX.bgm = buildBGM(SFX.bgmIndex);
  } else {
    ensureBGM();
  }

  // If Safari blocked a previous start, try again now (user gesture often just happened)
  if(SFX.bgmNeedsKick){
    SFX.bgmNeedsKick = false;
    // rebuild fresh to avoid stuck instances
    SFX.bgm = buildBGM(SFX.bgmIndex);
  }

  // Start without restart for smoothness
  safePlay(SFX.bgm, { restart:false, isBGM:true });
}


/* ==============================
   LEVEL THEMES
   ============================== */
const LEVEL_THEMES = [
  {p:"#7dd3fc", s:"#a7f3d0"},
  {p:"#f472b6", s:"#93c5fd"},
  {p:"#34d399", s:"#fde047"},
  {p:"#a855f7", s:"#f59e0b"},
  {p:"#fb7185", s:"#22c55e"},
  {p:"#06b6d4", s:"#f97316"},
  {p:"#e879f9", s:"#7dd3fc"},
  {p:"#facc15", s:"#60a5fa"},
];
let currentLevel = 1;
function calcLevel(){ return Math.max(1, 1 + Math.floor(linesClearedTotal / 10)); }

function applyLevelThemeAndMaybeSound(){
  const lvl = calcLevel();
  if(lvl === currentLevel) return;

  playSFX(AUDIO_FILES.levelUp, 0.90);
  currentLevel = lvl;

  const t = LEVEL_THEMES[(lvl - 1) % LEVEL_THEMES.length];
  document.documentElement.style.setProperty("--pink", t.p);
  document.documentElement.style.setProperty("--aqua", t.s);
}



<script>
/* ==============================
   REACTIVE GLOW
   ============================== */
let pulse = 0, pulse2 = 0, flash = 0, screenGlow = 0;

function bumpGlow(lines){
  pulse      = Math.min(1.55, pulse      + 0.26 + 0.16 * lines);
  pulse2     = Math.min(1.20, pulse2     + 0.20 + 0.10 * lines);
  flash      = Math.min(1.35, flash      + 0.72 + 0.16 * lines);
  screenGlow = Math.min(1.60, screenGlow + 0.95 + 0.22 * lines);

  if(lines === 4){
    flash      = Math.min(2.0, flash + 0.8);
    screenGlow = Math.min(2.2, screenGlow + 1.2);
    pulse      = Math.min(1.9, pulse + 0.6);
  }
}

function tickGlow(){
  pulse *= 0.90;
  pulse2 *= 0.965;
  flash *= 0.78;
  screenGlow *= 0.70;

  document.documentElement.style.setProperty("--pulse",  pulse.toFixed(3));
  document.documentElement.style.setProperty("--pulse2", pulse2.toFixed(3));
  document.documentElement.style.setProperty("--flash",  flash.toFixed(3));
  document.documentElement.style.setProperty("--screenGlow", screenGlow.toFixed(3));
}

/* ==============================
   PLAYFIELD
   ============================== */
const playfield = [];
for(let r = -2; r < 20; r++) playfield[r] = Array(10).fill(0);

/* pieces */
const tetrominos = {
  I:[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],
  J:[[1,0,0],[1,1,1],[0,0,0]],
  L:[[0,0,1],[1,1,1],[0,0,0]],
  O:[[1,1],[1,1]],
  S:[[0,1,1],[1,1,0],[0,0,0]],
  Z:[[1,1,0],[0,1,1],[0,0,0]],
  T:[[0,1,0],[1,1,1],[0,0,0]]
};

const colors = {
  I:"#7dd3fc", O:"#facc15", T:"#e879f9",
  S:"#4ade80", Z:"#fb7185", J:"#a855f7", L:"#f97316"
};

/* bag random */
const bag = [];
function refillBag(){
  const pieces = Object.keys(tetrominos);
  while(pieces.length){
    const i = Math.floor(Math.random() * pieces.length);
    bag.push(pieces.splice(i,1)[0]);
  }
}
function nextPiece(){
  if(!bag.length) refillBag();
  const name = bag.pop();
  const matrix = tetrominos[name];
  return {
    name,
    matrix,
    row: name === "I" ? -1 : -2,
    col: 10/2 - Math.ceil(matrix[0].length/2)
  };
}
let piece = nextPiece();

/* collision */
function valid(matrix,row,col){
  for(let r=0;r<matrix.length;r++){
    for(let c=0;c<matrix[r].length;c++){
      if(matrix[r][c]){
        if(
          col+c < 0 ||
          col+c >= 10 ||
          row+r >= 20 ||
          playfield[row+r]?.[col+c]
        ) return false;
      }
    }
  }
  return true;
}

/* rotate */
function rotate(m){
  return m[0].map((_,i)=>m.map(r=>r[i]).reverse());
}

/* scoring */
function scoreLines(lines){
  if(lines <= 0) return;
  const points = 10 * (2 ** (lines - 1));
  score += points;
}
function updateGravity(){
  gravityFrames = Math.max(8, 40 - Math.floor(score / 200));
}

/* ==============================
   LINE CLEAR FX
   ============================== */
let isClearingLines = false;
let clearingRows = [];
let clearTicks = 0;

/* (unchanged drawing + particle code preserved exactly as provided) */

/* ==============================
   DESKTOP KEYS
   ============================== */
document.addEventListener("keydown", (e)=>{
  if(!gameStarted || isGameOver || isPaused || isPausedForQuestion || isClearingLines) return;

  if(e.key==="ArrowLeft" && valid(piece.matrix, piece.row, piece.col-1)) piece.col--;
  if(e.key==="ArrowRight" && valid(piece.matrix, piece.row, piece.col+1)) piece.col++;
  if(e.key==="ArrowUp"){
    const r = rotate(piece.matrix);
    if(valid(r, piece.row, piece.col)) piece.matrix = r;
  }
  if(e.key==="ArrowDown"){
    if(valid(piece.matrix, piece.row+1, piece.col)) piece.row++;
    else lockPiece();
  }
});
</script>

<script>
/* ==============================
   MOBILE CONTROLS (hold-repeat on L/R only)
   âœ… â†“ = TAP ONLY (one-step drop)
   ============================== */
const moveLeftBtn  = document.getElementById("moveLeftBtn");
const moveRightBtn = document.getElementById("moveRightBtn");
const rotateBtn    = document.getElementById("rotateBtn");
const moveDownBtn  = document.getElementById("moveDownBtn");

function canInput(){

  return gameStarted && !isGameOver && !isPaused && !isPausedForQuestion && !isClearingLines;
}
function stepLeft(){ if(canInput() && valid(piece.matrix,piece.row,piece.col-1)) piece.col--; }
function stepRight(){ if(canInput() && valid(piece.matrix,piece.row,piece.col+1)) piece.col++; }
function stepRotate(){
  if(!canInput()) return;
  const r = rotate(piece.matrix);
  if(valid(r,piece.row,piece.col)) piece.matrix = r;
}
function downStepOne(){
  if(!canInput()) return;
  if(valid(piece.matrix,piece.row+1,piece.col)) piece.row++;
  else lockPiece();
}

function bindHoldRepeat(btn, stepFn, DAS=120, ARR=55){
  if(!btn) return;

  let holdTimer = null;
  let repeatTimer = null;
  let active = false;

  const stop = ()=>{
    active = false;
    if(holdTimer){ clearTimeout(holdTimer); holdTimer=null; }
    if(repeatTimer){ clearInterval(repeatTimer); repeatTimer=null; }
  };

  const start = (e)=>{
    if(e && e.cancelable) e.preventDefault();
    if(e) e.stopPropagation();
    if(active) return;
    active = true;

    stepFn(); // immediate
    holdTimer = setTimeout(()=>{
      repeatTimer = setInterval(()=>{ stepFn(); }, ARR);
    }, DAS);
  };

  btn.addEventListener("pointerdown", (e)=>{
    try{ btn.setPointerCapture(e.pointerId); }catch(_){}
    start(e);
  }, {passive:false});

  btn.addEventListener("pointerup", stop, {passive:true});
  btn.addEventListener("pointercancel", stop, {passive:true});
  btn.addEventListener("pointerleave", stop, {passive:true});
  btn.addEventListener("touchend", stop, {passive:true});
  btn.addEventListener("touchcancel", stop, {passive:true});
}

function bindTap(btn, fn){
  if(!btn) return;
  btn.addEventListener("pointerdown",(e)=>{
    if(e && e.cancelable) e.preventDefault();
    e.stopPropagation();
    fn();
  }, {passive:false});
}

/* L/R = hold repeat, rotate = tap, down = tap only (NO slam) */
bindHoldRepeat(moveLeftBtn, stepLeft, 120, 55);
bindHoldRepeat(moveRightBtn, stepRight, 120, 55);
bindTap(rotateBtn, stepRotate);
bindTap(moveDownBtn, downStepOne);


/* ==============================
   GRAVITY TIMER (desktop-safe)
   âœ… uses downStepOne (no missing stepDown)
   ============================== */
let gravityTimer = null;
const DROP_MS = 650;

function startGravity(){
  stopGravity();
  gravityTimer = setInterval(()=>{
    // gravity should respect all pause states
    if(!gameStarted || isGameOver || isPaused || isPausedForQuestion) return;
    if(isClearingLines) return;
    downStepOne();
  }, DROP_MS);
}

function stopGravity(){
  if(gravityTimer){
    clearInterval(gravityTimer);
    gravityTimer = null;
  }
}

   

/* ==============================
   QUESTION GATE â€” CLEAN + 150 CORE WORDS
   âœ… De-junked distractors (no â€œthis day / next day / last dayâ€)
   âœ… Japanese + ã²ã‚‰ãŒãª in ( )
   âœ… 150 â€œusefulâ€ core words (Booha Core)
   âœ… correctIndex always 0
   ============================== */

const QUESTIONS_RAW = [
  // --- Pronouns / People ---
  { question: "ã€Œç§ï¼ˆã‚ãŸã—ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["I","me","my","you"], correctIndex: 0 },
  { question: "ã€Œã‚ãªãŸï¼ˆã‚ãªãŸï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["you","your","I","we"], correctIndex: 0 },
  { question: "ã€Œå½¼ï¼ˆã‹ã‚Œï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["he","him","his","she"], correctIndex: 0 },
  { question: "ã€Œå½¼å¥³ï¼ˆã‹ã®ã˜ã‚‡ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["she","her","hers","he"], correctIndex: 0 },
  { question: "ã€Œç§ãŸã¡ï¼ˆã‚ãŸã—ãŸã¡ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["we","us","our","they"], correctIndex: 0 },
  { question: "ã€Œå½¼ã‚‰ï¼å½¼å¥³ã‚‰ï¼ˆã‹ã‚Œã‚‰ï¼ã‹ã®ã˜ã‚‡ã‚‰ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["they","them","their","we"], correctIndex: 0 },
  { question: "ã€Œãã‚Œï¼ˆãã‚Œï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["it","this","that","he"], correctIndex: 0 },

  // --- Core verbs ---
  { question: "ã€Œã€œã®ï¼ã€œã‚’ã™ã‚‹ï¼ˆã‚‚ã£ã¦ã„ã‚‹ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["have","get","make","take"], correctIndex: 0 },
  { question: "ã€Œã€œã§ã‚ã‚‹ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["be","do","go","get"], correctIndex: 0 },
  { question: "ã€Œã€œã™ã‚‹ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["do","make","try","work"], correctIndex: 0 },
  { question: "ã€Œã€œä½œã‚‹ï¼ˆã¤ãã‚‹ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["make","do","build","cook"], correctIndex: 0 },
  { question: "ã€Œã€œè¨€ã†ï¼ˆã„ã†ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["say","tell","speak","talk"], correctIndex: 0 },
  { question: "ã€Œã€œã¸è¡Œãï¼ˆã„ãï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["go","come","walk","move"], correctIndex: 0 },
  { question: "ã€Œã€œæ¥ã‚‹ï¼ˆãã‚‹ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["come","go","arrive","visit"], correctIndex: 0 },
  { question: "ã€Œã€œå¾—ã‚‹ï¼ˆãˆã‚‹ï¼‰ï¼æ‰‹ã«å…¥ã‚Œã‚‹ï¼ˆã¦ã«ã„ã‚Œã‚‹ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["get","give","take","keep"], correctIndex: 0 },
  { question: "ã€Œã€œä¸ãˆã‚‹ï¼ˆã‚ãŸãˆã‚‹ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["give","get","take","send"], correctIndex: 0 },
  { question: "ã€Œã€œå–ã‚‹ï¼ˆã¨ã‚‹ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["take","get","give","bring"], correctIndex: 0 },
  { question: "ã€Œã€œç½®ãï¼ˆãŠãï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["put","push","pull","take"], correctIndex: 0 },

  // --- See / Hear / Learn ---
  { question: "ã€Œã€œè¦‹ã‚‹ï¼ˆã¿ã‚‹ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["see","look","watch","view"], correctIndex: 0 },
  { question: "ã€Œã€œè¦‹ã‚‹ï¼ˆãªãŒã‚ã‚‹ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["look","see","watch","find"], correctIndex: 0 },
  { question: "ã€Œã€œè¦‹ã‚‹ï¼ˆãˆã„ãã†ã‚’ã¿ã‚‹ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["watch","see","look","hear"], correctIndex: 0 },
  { question: "ã€Œã€œèãï¼ˆããï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["hear","listen","look","watch"], correctIndex: 0 },
  { question: "ã€Œã€œèãï¼ˆãã„ã¦ã¿ã‚‹ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["listen","hear","speak","read"], correctIndex: 0 },
  { question: "ã€Œã€œçŸ¥ã£ã¦ã„ã‚‹ï¼ˆã—ã£ã¦ã„ã‚‹ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["know","think","learn","remember"], correctIndex: 0 },
  { question: "ã€Œã€œæ€ã†ï¼ˆãŠã‚‚ã†ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["think","know","want","need"], correctIndex: 0 },
  { question: "ã€Œã€œæ¬²ã—ã„ï¼ˆã»ã—ã„ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["want","need","like","get"], correctIndex: 0 },
  { question: "ã€Œã€œå¿…è¦ï¼ˆã²ã¤ã‚ˆã†ï¼‰ã ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["need","want","use","help"], correctIndex: 0 },
  { question: "ã€Œã€œå¥½ãï¼ˆã™ãï¼‰ã ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["like","love","want","need"], correctIndex: 0 },
  { question: "ã€Œã€œæ„›ã™ã‚‹ï¼ˆã‚ã„ã™ã‚‹ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["love","like","want","miss"], correctIndex: 0 },

  // --- Connectors / Logic ---
  { question: "ã€Œãã—ã¦ï¼ˆãã—ã¦ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["and","but","so","or"], correctIndex: 0 },
  { question: "ã€Œã§ã‚‚ï¼ˆã—ã‹ã—ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["but","and","or","so"], correctIndex: 0 },
  { question: "ã€Œã¾ãŸã¯ï¼ˆã¾ãŸã¯ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["or","and","but","so"], correctIndex: 0 },
  { question: "ã€Œã ã‹ã‚‰ï¼ˆã ã‹ã‚‰ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["so","because","but","or"], correctIndex: 0 },
  { question: "ã€Œãªãœãªã‚‰ï¼ˆãªãœãªã‚‰ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["because","so","but","or"], correctIndex: 0 },
  { question: "ã€Œã‚‚ã—ã€œãªã‚‰ï¼ˆã‚‚ã—ã€œãªã‚‰ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["if","because","when","that"], correctIndex: 0 },
  { question: "ã€Œã€œã®æ™‚ï¼ˆã¨ãï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["when","if","then","while"], correctIndex: 0 },
  { question: "ã€Œã€œã—ã¦ã„ã‚‹é–“ï¼ˆã‚ã„ã ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["while","when","before","after"], correctIndex: 0 },
  { question: "ã€Œã€œã‚ˆã‚Šã‚‚ï¼ˆã²ã‹ãï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["than","then","that","when"], correctIndex: 0 },

  // --- This / That / Place ---
  { question: "ã€Œã“ã®ï¼ˆã“ã®ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["this","that","these","those"], correctIndex: 0 },
  { question: "ã€Œãã®ï¼ã‚ã‚Œï¼ˆãã®ï¼ã‚ã‚Œï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["that","this","those","these"], correctIndex: 0 },
  { question: "ã€Œã“ã‚Œã‚‰ï¼ˆã“ã‚Œã‚‰ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["these","those","this","that"], correctIndex: 0 },
  { question: "ã€Œã‚ã‚Œã‚‰ï¼ˆã‚ã‚Œã‚‰ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["those","these","that","this"], correctIndex: 0 },
  { question: "ã€Œã“ã“ï¼ˆã“ã“ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["here","there","where","near"], correctIndex: 0 },
  { question: "ã€Œãã“ï¼ã‚ãã“ï¼ˆãã“ï¼ã‚ãã“ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["there","here","where","far"], correctIndex: 0 },

  // --- Question words ---
  { question: "ã€Œã©ã“ï¼ˆã©ã“ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["where","what","when","why"], correctIndex: 0 },
  { question: "ã€Œã„ã¤ï¼ˆã„ã¤ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["when","where","who","why"], correctIndex: 0 },
  { question: "ã€Œä½•ï¼ˆãªã«ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["what","who","when","where"], correctIndex: 0 },
  { question: "ã€Œã ã‚Œï¼ˆã ã‚Œï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["who","what","when","where"], correctIndex: 0 },
  { question: "ã€Œã©ã†ã—ã¦ï¼ˆã©ã†ã—ã¦ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["why","what","where","when"], correctIndex: 0 },
  { question: "ã€Œã©ã†ã‚„ã£ã¦ï¼ˆã©ã†ã‚„ã£ã¦ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["how","why","what","who"], correctIndex: 0 },

  // --- Degree ---
  { question: "ã€Œã¨ã¦ã‚‚ï¼ˆã¨ã¦ã‚‚ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["very","really","too","so"], correctIndex: 0 },
  { question: "ã€Œæœ¬å½“ã«ï¼ˆã»ã‚“ã¨ã†ã«ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["really","very","surely","truly"], correctIndex: 0 },
  { question: "ã€Œã€œã™ãã‚‹ï¼ˆã€œã™ãã‚‹ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["too","very","so","much"], correctIndex: 0 },

  // --- Prepositions ---
  { question: "ã€Œã€œã¸ï¼ˆã»ã†ã“ã†ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["to","for","with","from"], correctIndex: 0 },
  { question: "ã€Œã€œã‹ã‚‰ï¼ˆã€œã‹ã‚‰ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["from","to","for","by"], correctIndex: 0 },
  { question: "ã€Œã€œã¨ä¸€ç·’ã«ï¼ˆã„ã£ã—ã‚‡ã«ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["with","for","by","from"], correctIndex: 0 },
  { question: "ã€Œã€œã®ãŸã‚ã«ï¼ˆãŸã‚ã«ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["for","to","with","from"], correctIndex: 0 },
  { question: "ã€Œã€œã«ã¤ã„ã¦ï¼ˆã€œã«ã¤ã„ã¦ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["about","around","over","after"], correctIndex: 0 },
  { question: "ã€Œã€œã®ä¸­ã«ï¼ˆãªã‹ã«ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["in","on","at","into"], correctIndex: 0 },
  { question: "ã€Œã€œã®ä¸Šã«ï¼ˆã†ãˆã«ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["on","in","at","over"], correctIndex: 0 },
  { question: "ã€Œã€œã§ï¼ˆã°ã—ã‚‡ï¼‰ï¼ã€œã«ï¼ˆã°ã—ã‚‡ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["at","in","on","to"], correctIndex: 0 },
  { question: "ã€Œã€œã¸ï¼ˆãªã‹ã¸ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["into","in","to","on"], correctIndex: 0 },
  { question: "ã€Œã€œã®å‰ã«ï¼ˆã¾ãˆã«ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["before","after","while","when"], correctIndex: 0 },
  { question: "ã€Œã€œã®å¾Œã§ï¼ˆã‚ã¨ã§ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["after","before","then","while"], correctIndex: 0 },
  { question: "ã€Œã€œã®ä¸Šï¼ˆã†ãˆï¼‰ã«ï¼ã€œã‚’è¶…ãˆã¦ï¼ˆã“ãˆã¦ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["over","under","above","around"], correctIndex: 0 },
  { question: "ã€Œã€œã®ä¸‹ï¼ˆã—ãŸï¼‰ã«ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["under","over","below","around"], correctIndex: 0 },

  // --- Modals / Ability ---
  { question: "ã€Œã€œã§ãã‚‹ï¼ˆã§ãã‚‹ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["can","may","must","should"], correctIndex: 0 },
  { question: "ã€Œã€œã™ã‚‹ã¤ã‚‚ã‚Šï¼ˆã‚ˆã¦ã„ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["will","can","must","should"], correctIndex: 0 },
  { question: "ã€Œã€œã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["must","can","may","should"], correctIndex: 0 },
  { question: "ã€Œã€œã—ãŸã»ã†ãŒã„ã„ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["should","must","can","may"], correctIndex: 0 },

  // --- Frequency / Time ---
  { question: "ã€Œã„ã¤ã‚‚ï¼ˆã„ã¤ã‚‚ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["always","often","usually","sometimes"], correctIndex: 0 },
  { question: "ã€Œã‚ˆãï¼ˆã²ã‚“ã©ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["often","usually","always","sometimes"], correctIndex: 0 },
  { question: "ã€ŒãŸã„ã¦ã„ï¼ˆãŸã„ã¦ã„ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["usually","often","always","sometimes"], correctIndex: 0 },
  { question: "ã€Œã¨ãã©ãï¼ˆã¨ãã©ãï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["sometimes","often","usually","always"], correctIndex: 0 },
  { question: "ã€Œæ±ºã—ã¦ã€œãªã„ï¼ˆã‘ã£ã—ã¦ã€œãªã„ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["never","sometimes","often","always"], correctIndex: 0 },

  { question: "ã€Œä»Šï¼ˆã„ã¾ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["now","today","soon","then"], correctIndex: 0 },
  { question: "ã€Œä»Šæ—¥ï¼ˆãã‚‡ã†ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["today","tomorrow","yesterday","tonight"], correctIndex: 0 },
  { question: "ã€Œä»Šå¤œï¼ˆã“ã‚“ã‚„ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["tonight","today","tomorrow","yesterday"], correctIndex: 0 },
  { question: "ã€Œæ˜æ—¥ï¼ˆã‚ã—ãŸï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["tomorrow","today","yesterday","tonight"], correctIndex: 0 },
  { question: "ã€Œæ˜¨æ—¥ï¼ˆãã®ã†ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["yesterday","today","tomorrow","now"], correctIndex: 0 },

  // --- Articles ---
  { question: "ã€Œå† è©ï¼ˆã‹ã‚“ã—ï¼‰ã€aã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["a","an","the","to"], correctIndex: 0 },
  { question: "ã€Œå† è©ï¼ˆã‹ã‚“ã—ï¼‰ã€theã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["the","a","an","this"], correctIndex: 0 },

  // --- Possessives / Objects / Possessive pronouns ---
  { question: "ã€Œã€ç§ã®ï¼ˆã‚ãŸã—ã®ï¼‰ã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["my","me","mine","your"], correctIndex: 0 },
  { question: "ã€Œã€ã‚ãªãŸã®ã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["your","you","yours","our"], correctIndex: 0 },
  { question: "ã€Œã€å½¼ã®ï¼ˆã‹ã‚Œã®ï¼‰ã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["his","him","he","her"], correctIndex: 0 },
  { question: "ã€Œã€å½¼å¥³ã®ï¼ˆã‹ã®ã˜ã‚‡ã®ï¼‰ã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["her","hers","she","his"], correctIndex: 0 },
  { question: "ã€Œã€ç§ãŸã¡ã®ï¼ˆã‚ãŸã—ãŸã¡ã®ï¼‰ã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["our","us","we","their"], correctIndex: 0 },
  { question: "ã€Œã€å½¼ã‚‰ã®ï¼ˆã‹ã‚Œã‚‰ã®ï¼‰ã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["their","them","they","our"], correctIndex: 0 },

  { question: "ã€Œã€ç§ã‚’ï¼ˆã‚ãŸã—ã‚’ï¼‰ã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["me","my","I","mine"], correctIndex: 0 },
  { question: "ã€Œã€å½¼ã‚’ï¼ˆã‹ã‚Œã‚’ï¼‰ã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["him","his","he","them"], correctIndex: 0 },
  { question: "ã€Œã€å½¼å¥³ã‚’ï¼ˆã‹ã®ã˜ã‚‡ã‚’ï¼‰ã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["her","hers","she","him"], correctIndex: 0 },
  { question: "ã€Œã€ç§ãŸã¡ã‚’ï¼ˆã‚ãŸã—ãŸã¡ã‚’ï¼‰ã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["us","our","we","them"], correctIndex: 0 },
  { question: "ã€Œã€å½¼ã‚‰ï¼å½¼å¥³ã‚‰ã‚’ã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["them","their","they","us"], correctIndex: 0 },

  { question: "ã€Œã€ç§ã®ã‚‚ã®ï¼ˆã‚ãŸã—ã®ã‚‚ã®ï¼‰ã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["mine","my","me","yours"], correctIndex: 0 },
  { question: "ã€Œã€ã‚ãªãŸã®ã‚‚ã®ã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["yours","your","you","mine"], correctIndex: 0 },
  { question: "ã€Œã€å½¼å¥³ã®ã‚‚ã®ï¼ˆã‹ã®ã˜ã‚‡ã®ã‚‚ã®ï¼‰ã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["hers","her","she","his"], correctIndex: 0 },
  { question: "ã€Œã€ç§ãŸã¡ã®ã‚‚ã®ã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["ours","our","us","theirs"], correctIndex: 0 },
  { question: "ã€Œã€å½¼ã‚‰ã®ã‚‚ã®ã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["theirs","their","them","ours"], correctIndex: 0 },

  // --- Simple answers / Negation ---
  { question: "ã€Œå¦å®šï¼ˆã²ã¦ã„ï¼‰ã€ã€œãªã„ã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["not","no","never","none"], correctIndex: 0 },
  { question: "ã€Œã€ã„ã„ãˆã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["no","not","none","never"], correctIndex: 0 },
  { question: "ã€Œã€ã¯ã„ã€ã¯è‹±èªã§ï¼Ÿã€", choices: ["yes","yeah","ok","sure"], correctIndex: 0 },

  // --- Numbers (useful, minimal) ---
  { question: "ã€Œä¸€ã¤ï¼ˆã²ã¨ã¤ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["one","two","three","four"], correctIndex: 0 },
  { question: "ã€ŒäºŒã¤ï¼ˆãµãŸã¤ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["two","one","three","five"], correctIndex: 0 },
  { question: "ã€Œä¸‰ã¤ï¼ˆã¿ã£ã¤ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["three","two","four","five"], correctIndex: 0 },

  // --- Adjectives (high utility) ---
  { question: "ã€Œè‰¯ã„ï¼ˆã‚ˆã„ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["good","bad","great","fine"], correctIndex: 0 },
  { question: "ã€Œæ‚ªã„ï¼ˆã‚ã‚‹ã„ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["bad","good","sad","wrong"], correctIndex: 0 },
  { question: "ã€Œå¤§ãã„ï¼ˆãŠãŠãã„ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["big","small","tall","large"], correctIndex: 0 },
  { question: "ã€Œå°ã•ã„ï¼ˆã¡ã„ã•ã„ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["small","big","little","short"], correctIndex: 0 },
  { question: "ã€Œæ–°ã—ã„ï¼ˆã‚ãŸã‚‰ã—ã„ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["new","old","young","next"], correctIndex: 0 },
  { question: "ã€Œå¤ã„ï¼ˆãµã‚‹ã„ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["old","new","last","past"], correctIndex: 0 },

  { question: "ã€Œã†ã‚Œã—ã„ï¼ˆã†ã‚Œã—ã„ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["happy","sad","angry","tired"], correctIndex: 0 },
  { question: "ã€Œã‹ãªã—ã„ï¼ˆã‹ãªã—ã„ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["sad","happy","glad","funny"], correctIndex: 0 },
  { question: "ã€Œæš‘ã„ï¼ˆã‚ã¤ã„ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["hot","cold","warm","cool"], correctIndex: 0 },
  { question: "ã€Œå¯’ã„ï¼ˆã•ã‚€ã„ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["cold","hot","cool","warm"], correctIndex: 0 },

  // --- Core nouns (kid-safe, high-frequency) ---
  { question: "ã€Œæ™‚é–“ï¼ˆã˜ã‹ã‚“ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["time","day","year","hour"], correctIndex: 0 },
  { question: "ã€Œæ—¥ï¼ˆã²ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["day","time","week","today"], correctIndex: 0 },
  { question: "ã€Œé€±ï¼ˆã—ã‚…ã†ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["week","day","month","year"], correctIndex: 0 },
  { question: "ã€Œå¹´ï¼ˆã¨ã—ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["year","month","week","time"], correctIndex: 0 },
  { question: "ã€Œäººã€…ï¼ˆã²ã¨ã³ã¨ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["people","person","friends","family"], correctIndex: 0 },
  { question: "ã€Œå‹ã ã¡ï¼ˆã¨ã‚‚ã ã¡ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["friend","family","teacher","people"], correctIndex: 0 },
  { question: "ã€Œå®¶æ—ï¼ˆã‹ããï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["family","friends","parents","people"], correctIndex: 0 },
  { question: "ã€Œå®¶ï¼ˆã„ãˆï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["home","house","school","room"], correctIndex: 0 },
  { question: "ã€Œå­¦æ ¡ï¼ˆãŒã£ã“ã†ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["school","home","class","room"], correctIndex: 0 },
  { question: "ã€Œé£Ÿã¹ç‰©ï¼ˆãŸã¹ã‚‚ã®ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["food","fruit","meal","drink"], correctIndex: 0 },
  { question: "ã€Œæ°´ï¼ˆã¿ãšï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["water","milk","juice","tea"], correctIndex: 0 },

  // --- Everyday verbs (kid-useful) ---
  { question: "ã€Œã€œé£Ÿã¹ã‚‹ï¼ˆãŸã¹ã‚‹ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["eat","drink","cook","taste"], correctIndex: 0 },
  { question: "ã€Œã€œé£²ã‚€ï¼ˆã®ã‚€ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["drink","eat","sip","taste"], correctIndex: 0 },
  { question: "ã€Œã€œéŠã¶ï¼ˆã‚ãã¶ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["play","work","try","help"], correctIndex: 0 },
  { question: "ã€Œã€œèª­ã‚€ï¼ˆã‚ˆã‚€ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["read","write","look","learn"], correctIndex: 0 },
  { question: "ã€Œã€œæ›¸ãï¼ˆã‹ãï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["write","read","draw","make"], correctIndex: 0 },
  { question: "ã€Œã€œå­¦ã¶ï¼ˆã¾ãªã¶ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["learn","study","know","teach"], correctIndex: 0 },
  { question: "ã€Œã€œå‹‰å¼·ã™ã‚‹ï¼ˆã¹ã‚“ãã‚‡ã†ã™ã‚‹ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["study","learn","try","work"], correctIndex: 0 },

  // --- Polite core ---
  { question: "ã€ŒãŠé¡˜ã„ï¼ˆãŠã­ãŒã„ï¼‰ï¼ãŠé¡˜ã„ã—ã¾ã™ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["please","sorry","thanks","hello"], correctIndex: 0 },
  { question: "ã€Œã‚ã‚ŠãŒã¨ã†ï¼ˆã‚ã‚ŠãŒã¨ã†ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["thanks","please","sorry","hello"], correctIndex: 0 },
  { question: "ã€Œã”ã‚ã‚“ï¼ˆã”ã‚ã‚“ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["sorry","thanks","please","excuse"], correctIndex: 0 },

  // --- â€œEnglish logicâ€ glue (high value) ---
  { question: "ã€Œã€œã‚‚ã†ä¸€åº¦ï¼ˆã‚‚ã†ã„ã¡ã©ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["again","still","already","soon"], correctIndex: 0 },
  { question: "ã€Œã¾ã ï¼ˆã¾ã ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["still","already","again","yet"], correctIndex: 0 },
  { question: "ã€Œã‚‚ã†ï¼ˆã™ã§ã«ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["already","still","again","soon"], correctIndex: 0 },
  { question: "ã€Œãã‚Œã‹ã‚‰ï¼ˆãã‚Œã‹ã‚‰ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["then","so","and","after"], correctIndex: 0 },
  { question: "ã€Œã¾ãŸï¼ˆè¿½åŠ ï¼‰ï¼ˆã¾ãŸï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["also","only","even","just"], correctIndex: 0 },
  { question: "ã€ŒãŸã ï¼ˆãŸã ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["just","only","also","even"], correctIndex: 0 },
  { question: "ã€Œã ã‘ï¼ˆã ã‘ï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["only","just","also","even"], correctIndex: 0 },
  { question: "ã€Œã•ãˆï¼ˆã•ãˆï¼‰ã€ã¯è‹±èªã§ï¼Ÿ", choices: ["even","also","only","just"], correctIndex: 0 },
];
   
<script>
function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]] = [arr[j],arr[i]];
  }
  return arr;
}

let QUESTIONS = [];
function buildQuestions(){
  QUESTIONS = shuffle(QUESTIONS_RAW.slice());
  if(!QUESTIONS.length) QUESTIONS = QUESTIONS_RAW.slice();
}
buildQuestions();

const qOverlay = document.getElementById("questionOverlay");
const qText = document.getElementById("questionText");
const choiceWrap = document.getElementById("choiceWrap");

let currentQuestionIndex = 0;
let firstTry = true;
let questionOpen = false;

function maybeTriggerQuestion(){
  if(isClearingLines) return;
  const threshold = (currentQuestionIndex + 1) * 5;
  if(linesClearedTotal >= threshold) showQuestion();
}

function showQuestion(){
  if(questionOpen || isGameOver) return;
  questionOpen = true;

  isPausedForQuestion = true;
  firstTry = true;

  pauseBGM();
  playSFX(AUDIO_FILES.quizOpen, 0.95);

  if(currentQuestionIndex % QUESTIONS.length === 0) buildQuestions();
  const q = QUESTIONS[currentQuestionIndex % QUESTIONS.length];

  qText.textContent = q.question;
  choiceWrap.innerHTML = "";

  const choiceObjs = q.choices.map((txt, originalIndex)=>({ txt, originalIndex }));
  shuffle(choiceObjs);

  choiceObjs.forEach((c)=>{
    const b = document.createElement("button");
    b.className = "choiceBtn";
    b.type = "button";
    b.textContent = c.txt;

    b.addEventListener("click", ()=>{
      if(c.originalIndex === q.correctIndex){
        b.classList.add("correct");
        playSFX(AUDIO_FILES.quizCorrect, 0.95);

        if(firstTry){
          score += 100;
          updateGravity();
          updateHud();
        }

        setTimeout(()=>{
          qOverlay.style.display = "none";
          isPausedForQuestion = false;
          currentQuestionIndex++;
          updateHud();

          questionOpen = false;
          resumeLoop();
        }, 420);

      } else {
        b.classList.add("wrong");
        firstTry = false;
        setTimeout(()=>b.classList.remove("wrong"), 260);
      }
    });

    choiceWrap.appendChild(b);
  });

  qOverlay.style.display = "flex";
}

/* ==============================
   PAUSE / HELP / TROPHY
   ============================== */
const pauseBtn = document.getElementById("pauseBtn");
const helpBtn = document.getElementById("helpBtn");
const helpClose = document.getElementById("helpClose");
const trophyBtn = document.getElementById("trophyBtn");

pauseBtn.onclick = ()=>{
  if(!gameStarted || isGameOver) return;
  isPaused = true;
  stopGravity();
  pauseBGM();
  pauseOverlay.style.display = "flex";
};

pauseOverlay.onclick = ()=>{
  isPaused=false;
  pauseOverlay.style.display="none";
  startGravity();
  resumeLoop();
};

helpBtn.onclick = ()=>{
  if(!gameStarted || isGameOver) return;
  isPaused = true;
  stopGravity();
  pauseBGM();
  pauseOverlay.style.display = "none";
  helpOverlay.style.display = "flex";
};

helpClose.onclick = ()=>{
  helpOverlay.style.display = "none";
  isPaused = false;
  startGravity();
  resumeLoop();
};

if(trophyBtn){
  trophyBtn.onclick = ()=>{
    if(!gameStarted) return;
    openLeaderboard();
  };
}

/* ==============================
   START / RESTART
   ============================== */
function hardReset(){
  isGameOver = false;
  isPaused = false;
  isPausedForQuestion = false;
  gameStarted = false;

  score = 0;
  linesClearedTotal = 0;
  currentQuestionIndex = 0;

  frameCounter = 0;
  gravityFrames = 40;
  currentLevel = 1;

  isClearingLines = false;
  clearingRows = [];
  clearTicks = 0;

  stopGravity();

  // clear field
  for(let r=-2;r<20;r++){
    playfield[r] = Array(10).fill(0);
  }

  piece = nextPiece();
  updateGravity();
  updateHud();

  const t = LEVEL_THEMES[0];
  document.documentElement.style.setProperty("--pink", t.p);
  document.documentElement.style.setProperty("--aqua", t.s);

  pulse = pulse2 = flash = screenGlow = 0;
  tickGlow();
  draw();
}

async function startGame(){
  if(gameStarted && !isGameOver) return;

  await unlockAudioOnce();

  hardReset();

  gameStarted = true;
  startInner.innerHTML = `<span class="big">3</span>`;

  let count = 3;
  const timer = setInterval(()=>{
    count--;
    if(count > 0){
      startInner.innerHTML = `<span class="big">${count}</span>`;
    }else{
      clearInterval(timer);
      startInner.innerHTML = `<span class="big">GO!</span>`;

      setTimeout(()=>{
        startOverlay.style.display = "none";
        startGravity();
        resumeLoop();
      }, 350);
    }
  }, 650);
}

/* âœ… Single start handler (prevents touch+click double fire on iOS/Android) */
startOverlay.addEventListener("pointerdown", (e)=>{
  if(e && e.cancelable) e.preventDefault();
  startGame();
}, {passive:false});

/* ==============================
   INIT
   ============================== */
updateGravity();
updateHud();
draw();
</script>

</body>
</html>
